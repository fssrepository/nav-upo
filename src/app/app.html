<!-- * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * -->
<!-- * * * * * * * * * * * The content below * * * * * * * * * * * -->
<!-- * * * * * * * * * * is only a placeholder * * * * * * * * * * -->
<!-- * * * * * * * * * * and can be replaced.  * * * * * * * * * * -->
<!-- * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * -->
<!-- * * * * * * * * * Delete the template below * * * * * * * * * -->
<!-- * * * * * * * to get started with your project! * * * * * * * -->
<!-- * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * -->



<main class="main">
  <div class="content">

    <!-- Mobile Menu Button -->
    <button mat-icon-button class="mobile-menu-btn-global" (click)="toggleMobileMenu()" aria-label="Menü">
      <mat-icon>menu</mat-icon>
      <span class="badge-dot" *ngIf="menuBadgeTotal > 0">{{ menuBadgeTotal }}</span>
    </button>

    <!-- User Selector Button - Global -->
    <button mat-icon-button class="user-selector-btn-global" (click)="onUserSelect()" aria-label="Felhasználó választása">
      <span class="user-initial">F</span>
      <span class="badge-dot" *ngIf="userBadgeCount > 0">{{ userBadgeCount }}</span>
    </button>

    <!-- Mobile Menu Panel -->
    <div class="mobile-menu-backdrop" [class.open]="showMobileMenu" (click)="closeMobileMenu()" *ngIf="showMobileMenu"></div>
    <div class="mobile-menu-panel-global" [class.open]="showMobileMenu">
      <div class="menu-header menu-header-row">
        <img src="assets/img/nav-logo.svg" alt="NAV" />
        <button class="balance-card" type="button" (click)="openPopup('balance')" aria-label="Egyenleg megnyitása">
          <span class="balance-title">Egyenleg</span>
          <span class="balance-value">-200e Ft</span>
        </button>
      </div>
      <div class="menu-items">
        <a class="menu-item" routerLink="/home" routerLinkActive="active" [routerLinkActiveOptions]="{ exact: true }" (click)="closeMobileMenu()">
          <mat-icon>home</mat-icon>
          <span>Kezdőoldal</span>
          <span class="item-badge" *ngIf="menuBadges.home > 0">{{ menuBadges.home }}</span>
        </a>
        <a class="menu-item" routerLink="/documents" routerLinkActive="active" [routerLinkActiveOptions]="{ exact: true }" (click)="closeMobileMenu()">
          <mat-icon>description</mat-icon>
          <span>Dokumentumok</span>
          <span class="item-badge" *ngIf="menuBadges.documents > 0">{{ menuBadges.documents }}</span>
        </a>
        <a class="menu-item" routerLink="/documents/szamlak" routerLinkActive="active" (click)="closeMobileMenu()">
          <mat-icon>receipt_long</mat-icon>
          <span>Bizonylatok</span>
          <span class="item-badge" *ngIf="menuBadges.invoices > 0">{{ menuBadges.invoices }}</span>
        </a>
        <button class="menu-item menu-item-action" type="button" (click)="openPopup('contact')">
          <mat-icon>support_agent</mat-icon>
          <span>Kapcsolat</span>
        </button>
        <button class="menu-item menu-item-action" type="button" (click)="openPopup('settings')">
          <mat-icon>settings</mat-icon>
          <span>Beállítások</span>
        </button>
      </div>
    </div>

    <nav class="sidebar" aria-label="Primary navigation">
      <div class="sidebar-top">
        <img src="assets/img/nav-logo.svg" alt="NAV" />
        <button class="balance-card" type="button" (click)="openPopup('balance')" aria-label="Egyenleg megnyitása">
          <span class="balance-title">Egyenleg</span>
          <span class="balance-value">-200e Ft</span>
        </button>
      </div>
      <mat-nav-list>
        <a mat-list-item routerLink="/home" routerLinkActive="selected" [routerLinkActiveOptions]="{ exact: true }">
          <mat-icon aria-hidden="false" aria-label="Kezdőoldal">home</mat-icon>
          <span>Kezdőoldal</span>
          <span class="menu-badge" *ngIf="menuBadges.home > 0">{{ menuBadges.home }}</span>
        </a>
        <a mat-list-item routerLink="/documents" routerLinkActive="selected" [routerLinkActiveOptions]="{ exact: true }">
          <mat-icon aria-hidden="false" aria-label="Dokumentumok">description</mat-icon>
          <span>Dokumentumok</span>
          <span class="menu-badge" *ngIf="menuBadges.documents > 0">{{ menuBadges.documents }}</span>
        </a>
        <a mat-list-item routerLink="/documents/szamlak" routerLinkActive="selected">
          <mat-icon aria-hidden="false" aria-label="Bizonylatok">receipt_long</mat-icon>
          <span>Bizonylatok</span>
          <span class="menu-badge" *ngIf="menuBadges.invoices > 0">{{ menuBadges.invoices }}</span>
        </a>
        <button mat-list-item type="button" class="menu-item-action" (click)="openPopup('contact')">
          <mat-icon aria-hidden="false" aria-label="Kapcsolat">support_agent</mat-icon>
          <span>Kapcsolat</span>
        </button>
        <button mat-list-item type="button" class="menu-item-action" (click)="openPopup('settings')">
          <mat-icon aria-hidden="false" aria-label="Beállítások">settings</mat-icon>
          <span>Beállítások</span>
        </button>
      </mat-nav-list>
    </nav>
    <section class="content-area">
      <router-outlet></router-outlet>
    </section>
  </div>
</main>

<section class="app-popup" *ngIf="activePopup">
  <div class="app-popup-backdrop" (click)="closePopup()"></div>
  <div class="app-popup-panel" (click)="$event.stopPropagation()">
    <div class="popup-header">
      <div class="popup-title">
        <h2>{{ getPopupTitle() }}</h2>
      </div>
      <span class="popup-balance-value" *ngIf="activePopup === 'balance'">{{ balanceValue }}</span>
      <button mat-icon-button class="popup-close" (click)="closePopup()" aria-label="Bezárás">
        <mat-icon>close</mat-icon>
      </button>
    </div>
    <div class="popup-body">
      <div *ngIf="activePopup === 'contact'" class="contact-content">
        {{ contactContent }}
      </div>
      <div *ngIf="activePopup === 'settings'">
        <mat-accordion class="popup-accordion" multi>
          <mat-expansion-panel *ngFor="let panel of settingsPanels">
            <mat-expansion-panel-header>
              <mat-panel-title>{{ panel.title }}</mat-panel-title>
            </mat-expansion-panel-header>
            <div class="accordion-content" *ngIf="panel.items?.length">
              <ul class="popup-list" *ngIf="panel.title === 'Képviseletek' || panel.title === 'Értesítő szabályok'; else popupParagraphs">
                <li *ngFor="let item of panel.items" class="popup-list-item" [class]="'popup-list-item level-' + getItemLevel(item)">
                  {{ getItemText(item) }}
                </li>
              </ul>
              <ng-template #popupParagraphs>
                <p *ngFor="let item of panel.items">{{ getItemText(item) }}</p>
              </ng-template>
            </div>
          </mat-expansion-panel>
        </mat-accordion>
      </div>
      <div *ngIf="activePopup === 'balance'">
        <mat-accordion class="popup-accordion" multi>
          <mat-expansion-panel *ngFor="let panel of balancePanels">
            <mat-expansion-panel-header>
              <mat-panel-title>{{ panel.title }}</mat-panel-title>
            </mat-expansion-panel-header>
            <div class="accordion-content" *ngIf="panel.items?.length">
              <p *ngFor="let item of panel.items">{{ getItemText(item) }}</p>
            </div>
            <mat-accordion class="sub-accordion" *ngIf="panel.subpanels?.length" multi>
              <mat-expansion-panel *ngFor="let subpanel of panel.subpanels">
                <mat-expansion-panel-header>
                  <mat-panel-title>{{ subpanel.title }}</mat-panel-title>
                </mat-expansion-panel-header>
              </mat-expansion-panel>
            </mat-accordion>
          </mat-expansion-panel>
        </mat-accordion>
      </div>
    </div>
  </div>
</section>

<!-- * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * -->
<!-- * * * * * * * * * * * The content above * * * * * * * * * * * * -->
<!-- * * * * * * * * * * is only a placeholder * * * * * * * * * * * -->
<!-- * * * * * * * * * * and can be replaced.  * * * * * * * * * * * -->
<!-- * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * -->
<!-- * * * * * * * * * * End of Placeholder  * * * * * * * * * * * * -->
<!-- * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * -->
